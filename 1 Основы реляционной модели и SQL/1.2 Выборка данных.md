## Выборка данных

Выборка **ВСЕХ** данных из таблицы:

```sql
SELECT * FROM book;
```
Вывод:
```commandline
Query result:
+---------+-----------------------+------------------+--------+--------+
| book_id | title                 | author           | price  | amount |
+---------+-----------------------+------------------+--------+--------+
| 1       | Мастер и Маргарита    | Булгаков М.А.    | 670.99 | 3      |
| 2       | Белая гвардия         | Булгаков М.А.    | 540.50 | 5      |
| 3       | Идиот                 | Достоевский Ф.М. | 460.00 | 10     |
| 4       | Братья Карамазовы     | Достоевский Ф.М. | 799.01 | 2      |
| 5       | Стихотворения и поэмы | Есенин С.А.      | 650.00 | 15     |
+---------+-----------------------+------------------+--------+--------+
Affected rows: 5
```
___  

Выборка **ОТДЕЛЬНЫХ** столбцов:
```sql
SELECT title, amount FROM book;
```
Вывод:
```commandline
Query result:
+------------------+-----------------------+--------+
| author           | title                 | price  |
+------------------+-----------------------+--------+
| Булгаков М.А.    | Мастер и Маргарита    | 670.99 |
| Булгаков М.А.    | Белая гвардия         | 540.50 |
| Достоевский Ф.М. | Идиот                 | 460.00 |
| Достоевский Ф.М. | Братья Карамазовы     | 799.01 |
| Есенин С.А.      | Стихотворения и поэмы | 650.00 |
+------------------+-----------------------+--------+
Affected rows: 5
```
___

## Присвоение новых имен столбцам при формировании выборки

Для того чтобы отобрать данные из определенных столбцов таблицы и одновременно задать столбцам новые названия в  
результате выборки используется SQL запрос следующей структуры: 

- ключевое слово `SELECT`; 
- имя столбца;
- ключевое слово `AS`; 
- новое название столбца (можно русскими буквами), выводимое в результате запроса, но это должно быть одно слово, если  
название состоит из двух слов – соединяйте их подчеркиванием, например, `Количество_книг`; 
- запятая; 
- имя столбца; 
- .... 
- ключевое слово `FROM`; 
- имя таблицы.

Запрос:
```sql
SELECT title AS Название, author AS Автор
FROM book;
```
Вывод:
```commandline
Query result:
+-----------------------+------------------+
| Название              | Автор            |
+-----------------------+------------------+
| Мастер и Маргарита    | Булгаков М.А.    |
| Белая гвардия         | Булгаков М.А.    |
| Идиот                 | Достоевский Ф.М. |
| Братья Карамазовы     | Достоевский Ф.М. |
| Стихотворения и поэмы | Есенин С.А.      |
+-----------------------+------------------+
Affected rows: 5
```
___

## Выборка данных с созданием вычисляемого столбца

С помощью SQL запросов можно осуществлять вычисления по каждой строке таблицы с помощью вычисляемого столбца. Для  
него в списке полей после оператора `SELECT` указывается выражение и задается имя.

Выражение может включать имена столбцов, константы, знаки операций, встроенные функции.  

Результатом является таблица, в которую включены все данные из указанных после `SELECT` столбцов, а также новый  
столбец, в каждой строке которого вычисляется заданное выражение.

Запрос:

```sql
SELECT title, amount, amount * 1.65 AS pack
FROM book;
```

```commandline
Query result:
+-----------------------+--------+-------+
| title                 | amount | pack  |
+-----------------------+--------+-------+
| Мастер и Маргарита    | 3      | 4.95  |
| Белая гвардия         | 5      | 8.25  |
| Идиот                 | 10     | 16.50 |
| Братья Карамазовы     | 2      | 3.30  |
| Стихотворения и поэмы | 15     | 24.75 |
+-----------------------+--------+-------+
Affected rows: 5
```
___

## Выборка данных, вычисляемые столбцы, математические функции

В SQL реализовано множество математических функций для работы с числовыми данными. Некоторые из них:

- `CEILING(x)` - возвращает наименьшее целое число, большее или равное **x** (округляет до целого числа в большую  
сторону). (`CEILING(4.2)=5`, `CEILING(-5.8)=-5`);
- `ROUND(x, k)` - округляет значение **x** до **k** знаков после запятой, если **k** не указано – **x** округляется до  
целого. (`ROUND(4.361)=4`, `ROUND(5.86592,1)=5.9`);
- `FLOOR(x)` - возвращает наибольшее целое число, меньшее или равное **x** (округляет до целого числа в меньшую  
сторону). (`FLOOR(4.2)=4`, `FLOOR(-5.8)=-6`);
- `POWER(x, y)` - возведение **x** в степень **y**.(`POWER(3,4)=81.0`);
- `SQRT(x)` - квадратный корень из **x**.(`SQRT(4)=2.0`, `SQRT(2)=1.41...`);
- `DEGREES(x)` - конвертирует значение **x** из радиан в градусы. (`DEGREES(3) = 171.8...`);
- `RADIANS(x)` - конвертирует значение **x** из градусов в радианы. (`RADIANS(180)=3.14...`);
- `ABS(x)` - модуль числа **x**.(`ABS(-1) = 1`, `ABS(1) = 1`);
- `PI()` - pi = 3.1415926...

Запрос:
```sql
SELECT title, author, amount,
ROUND(price*0.7, 2) as new_price
FROM book;
```
Вывод:
```commandline
Query result:
+-----------------------+------------------+--------+-----------+
| title                 | author           | amount | new_price |
+-----------------------+------------------+--------+-----------+
| Мастер и Маргарита    | Булгаков М.А.    | 3      | 469.69    |
| Белая гвардия         | Булгаков М.А.    | 5      | 378.35    |
| Идиот                 | Достоевский Ф.М. | 10     | 322.00    |
| Братья Карамазовы     | Достоевский Ф.М. | 2      | 559.31    |
| Стихотворения и поэмы | Есенин С.А.      | 15     | 455.00    |
+-----------------------+------------------+--------+-----------+
Affected rows: 5
```
___

## Выборка данных, вычисляемые столбцы, логические функции

В SQL реализована возможность заносить в поле значение в зависимости от условия. Для этого используется функция `IF()`:  

`IF(логическое_выражение, выражение_1, выражение_2)`

Функция вычисляет `логическое_выражение`, если оно истина – в поле заносится значение `выражения_1`, в противном случае –  
значение `выражения_2`. Все три параметра `IF()` являются обязательным.

Допускается использование вложенных функций, вместо `выражения_1` или `выражения_2` может стоять новая функция `IF`.

Запрос:
```sql
SELECT author, title,
ROUND(IF(author='Булгаков М.А.', price * 1.1, IF(author='Есенин С.А.', price * 1.05, price * 1 )), 2) as new_price
FROM book;
```
Вывод:
```commandline
Query result:
+------------------+-----------------------+-----------+
| author           | title                 | new_price |
+------------------+-----------------------+-----------+
| Булгаков М.А.    | Мастер и Маргарита    | 738.09    |
| Булгаков М.А.    | Белая гвардия         | 594.55    |
| Достоевский Ф.М. | Идиот                 | 460.00    |
| Достоевский Ф.М. | Братья Карамазовы     | 799.01    |
| Есенин С.А.      | Стихотворения и поэмы | 682.50    |
+------------------+-----------------------+-----------+
Affected rows: 5
```
___

## Выборка данных по условию

С помощью запросов можно включать в итоговую выборку не все строки исходной таблицы, а только те, которые отвечают  
некоторому условию. Для этого после указания таблицы, откуда выбираются данные, задается ключевое слово `WHERE` и  
логическое выражение, от результата которого зависит будет-ли включена строка в выборку или нет. Если условие –  
истина, то строка(запись) включается в выборку, если ложь – нет.

Запрос:
```sql
SELECT author,title, price
FROM book
WHERE amount < 10;
```
Пояснение:
_Вывести автора, название  и цены тех книг, количество которых меньше 10._

Вывод:
```commandline
Query result:
+------------------+--------------------+--------+
| author           | title              | price  |
+------------------+--------------------+--------+
| Булгаков М.А.    | Мастер и Маргарита | 670.99 |
| Булгаков М.А.    | Белая гвардия      | 540.50 |
| Достоевский Ф.М. | Братья Карамазовы  | 799.01 |
+------------------+--------------------+--------+
Affected rows: 3
```
___

## Выборка данных, логические операции

Логическое выражение после ключевого слова `WHERE` кроме операторов сравнения и выражений может включать  
**логические операции** (И «**and**», ИЛИ «**or**», НЕ «**not**») и круглые скобки, изменяющие приоритеты выполнения операций.

Приоритеты операций:

1) Круглые скобки;
2) Умножение  (*),  деление (/);
3) Сложение  (+), вычитание (-);
4) Операторы сравнения (=, >, <, >=, <=, <>);
5) NOT;
6) AND;
7) OR.

Пояснение:
_Вывести название, автора, цену и количество всех книг, цена которых меньше 500 или больше 600, а стоимость всех  
экземпляров этих книг больше или равна 5000._

Запрос:
```sql
SELECT title, author, price, amount
FROM book
WHERE (price < 500 or price > 600) and price * amount >= 5000;
```
Вывод:
```commandline
Query result:
+-----------------------+-------------+--------+--------+
| title                 | author      | price  | amount |
+-----------------------+-------------+--------+--------+
| Стихотворения и поэмы | Есенин С.А. | 650.00 | 15     |
+-----------------------+-------------+--------+--------+
Affected rows: 1
```
___

## Выборка данных, операторы BETWEEN, IN

Логическое выражение после ключевого слова `WHERE` может включать операторы `BETWEEN` и `IN`. Приоритет у этих операторов  
такой же как у операторов сравнения, то есть они выполняются раньше, чем `NOT`, `AND`, `OR`.

Оператор `BETWEEN` позволяет отобрать данные, относящиеся к некоторому интервалу, включая его границы.

Запрос:
```sql
SELECT title, author
FROM book
WHERE (price BETWEEN 540.50 AND 800) and (amount IN(2,3,5,7));
```
Пояснение:  
_Вывести название и авторов тех книг, цены которых принадлежат интервалу от 540.50 до 800 (включая границы), а  
количество или 2, или 3, или 5, или 7._
Вывод:
```commandline
Query result:
+--------------------+------------------+
| title              | author           |
+--------------------+------------------+
| Мастер и Маргарита | Булгаков М.А.    |
| Белая гвардия      | Булгаков М.А.    |
| Братья Карамазовы  | Достоевский Ф.М. |
+--------------------+------------------+
Affected rows: 3
```
___

## Выборка данных с сортировкой

При выборке можно указывать столбец или несколько столбцов, по которым необходимо отсортировать отобранные строки.  
Для этого используются ключевые слова `ORDER BY`, после которых задаются имена столбцов. При этом строки сортируются  
по первому столбцу, если указан второй столбец, сортировка осуществляется только для тех строк, у которых значения  
первого столбца одинаковы. По умолчанию `ORDER BY` выполняет сортировку по возрастанию. Чтобы управлять  
направлением сортировки вручную, после имени столбца указывается ключевое слово `ASC` (по возрастанию) или `DESC` (по  
убыванию). 

Столбцы после ключевого слова `ORDER BY` можно задавать:

- названием столбца;
- номером столбца;
- именем столбца (указанным после `AS`).

Запрос:
```sql
SELECT author, title
FROM book
WHERE amount BETWEEN 2 AND 14
ORDER BY author DESC, title;
```
Пояснение:  
Вывести автора и название книг, количество которых принадлежит интервалу от 2 до 14 (включая границы). Информацию 
отсортировать сначала по авторам (в обратном алфавитном порядке), а затем по названиям книг (по алфавиту).

Вывод:
```commandline
Query result:
+------------------+--------------------+
| author           | title              |
+------------------+--------------------+
| Достоевский Ф.М. | Братья Карамазовы  |
| Достоевский Ф.М. | Идиот              |
| Булгаков М.А.    | Белая гвардия      |s
| Булгаков М.А.    | Мастер и Маргарита |
+------------------+--------------------+
Affected rows: 4
```
___

## Выборка данных, оператор LIKE

Оператор `LIKE` используется для сравнения строк. В отличие от операторов отношения равно (**=**) и не равно (**<>**), `LIKE`  
позволяет сравнивать строки не на полное совпадение (не совпадение), а в соответствии с шаблоном. Шаблон может  
включать **обычные символы** и **символы-шаблоны**. При сравнении с шаблоном, его обычные символы должны в точности  
совпадать с символами, указанными в строке. Символы-шаблоны могут совпадать с произвольными элементами  
символьной строки.

| Символ-шаблон |                     Описание                      | Пример  |   
|:-------------:|:-------------------------------------------------:|:-------:|  
|       %       | Любая строка, содержащая ноль или более символов	 |    SELECT * FROM book WHERE author LIKE '%М.%'     |  
|       -       | Любой одиночный символ	 |  SELECT * FROM book WHERE title LIKE 'Поэм_'       |  

Запрос:
```sql
SELECT title, author
FROM book
WHERE ((title LIKE "% %" AND title NOT LIKE " ") AND (author LIKE "% С.%" OR author LIKE "% __С_"))
ORDER BY title;
```

Вывод:
```commandline
Query result:
+-----------------------+-------------+
| title                 | author      |
+-----------------------+-------------+
| Капитанская дочка     | Пушкин А.С. |
| Стихотворения и поэмы | Есенин С.А. |
+-----------------------+-------------+
Affected rows: 2
```
